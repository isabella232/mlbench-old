{% extends 'main/base.html' %}

{% block content %}
<div id="nodes-list" class="card-deck"></div>
{% endblock %}
{% block scripts %}
<script id="card-template" type="text/x-jsrender">
    <div class="card w-25 node-card" style="max-width:40rem">
        <div class="card-header <%if phase === 'Running'%>bg-success<%else phase === 'Pending'%>bg-warning<%else%>bg-danger<%/if%>">
            <%>name%>
        </div>
        <div class="card-body list-group">
            <div class="d-flex w-100 justify-content-between">
                <span class="mb-1">Labels: </span>
                <span><%>labels%></span>
            </div>
            <div class="d-flex w-100 justify-content-between">
                <span class="mb-1">Ip: </span>
                <span><%>ip%></span>
            </div>
            <div class="d-flex w-100 justify-content-between">
                <span class="mb-1">Phase: </span>
                <span><%>phase%></span>
            </div>
        </div>
    </div>
</script>
<script type="text/javascript">
    $(document).ready(function () {
        $.views.settings.delimiters("<%", "%>");

        var renderNodeInfo = function(){
            $.getJSON("/api/nodes", function(data){
                $("#nodes-list").empty();
                $.each(data, function(index, value){
                    var card = $("#card-template").render(value);
                    $("#nodes-list").append(card)
                })
            })

            setTimeout(renderNodeInfo, 1000)
        }

        renderNodeInfo();
    })
</script>
{% endblock %}